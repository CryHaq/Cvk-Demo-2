import{j as t,v as k,r as x,C as y,B as h,X as v,L as I}from"./index-BoosfMp7.js";import{T as N}from"./tag-C9mPU_kr.js";function j({className:n,type:s,...o}){return t.jsx("input",{"code-path":"src/components/ui/input.tsx:7:5",type:s,"data-slot":"input",className:k("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",n),...o})}const C=[{id:"1",code:"HOSGELDIN10",type:"percentage",value:10,minOrderAmount:100,maxDiscount:50,usageLimit:100,usageCount:45,validFrom:"2024-01-01",validUntil:"2024-12-31",isActive:!0,description:"Hoşgeldiniz indirimi - İlk alışverişinize %10 indirim"},{id:"2",code:"VIP20",type:"percentage",value:20,minOrderAmount:500,maxDiscount:100,usageLimit:50,usageCount:12,validFrom:"2024-01-01",validUntil:"2024-12-31",isActive:!0,description:"VIP müşteri indirimi - %20 indirim"},{id:"3",code:"SABIT50",type:"fixed",value:50,minOrderAmount:300,usageLimit:200,usageCount:89,validFrom:"2024-01-01",validUntil:"2024-12-31",isActive:!0,description:"Sabit 50€ indirim - 300€ ve üzeri alışverişlerde"},{id:"4",code:"BLACKFRIDAY",type:"percentage",value:30,minOrderAmount:200,maxDiscount:200,usageLimit:500,usageCount:0,validFrom:"2024-11-01",validUntil:"2024-11-30",isActive:!1,description:"Black Friday özel - %30 indirim"},{id:"5",code:"BEDAVAKARGO",type:"fixed",value:15,minOrderAmount:150,usageLimit:1e3,usageCount:234,validFrom:"2024-01-01",validUntil:"2024-12-31",isActive:!0,description:"Bedava kargo - 15€ kargo ücreti indirimi"}],u=()=>{const n=localStorage.getItem("cvk_mock_coupons");return n?JSON.parse(n):C},d=n=>{localStorage.setItem("cvk_mock_coupons",JSON.stringify(n))};localStorage.getItem("cvk_mock_coupons")||d(C);const w={validateCoupon:async(n,s)=>new Promise(o=>{setTimeout(()=>{const e=u().find(l=>l.code.toUpperCase()===n.toUpperCase());if(!e){o({success:!1,message:"Geçersiz kupon kodu"});return}if(!e.isActive){o({success:!1,message:"Bu kupon kodu aktif değil"});return}const i=new Date,p=new Date(e.validUntil);if(i>p){o({success:!1,message:"Bu kuponun süresi dolmuş"});return}if(e.usageCount>=e.usageLimit){o({success:!1,message:"Bu kuponun kullanım limiti dolmuş"});return}if(s<e.minOrderAmount){o({success:!1,message:`Bu kupon için minimum sipariş tutarı €${e.minOrderAmount}'dir`});return}let c=0;e.type==="percentage"?(c=s*e.value/100,e.maxDiscount&&c>e.maxDiscount&&(c=e.maxDiscount)):c=e.value,o({success:!0,coupon:{code:e.code,type:e.type,value:e.value,discountAmount:Number(c.toFixed(2))}})},600)}),applyCoupon:async n=>new Promise(s=>{setTimeout(()=>{const o=u(),r=o.findIndex(e=>e.code.toUpperCase()===n.toUpperCase());r!==-1?(o[r].usageCount+=1,d(o),s(!0)):s(!1)},300)}),getAllCoupons:async()=>new Promise(n=>{setTimeout(()=>{const s=u();n({success:!0,data:s})},400)}),createCoupon:async n=>new Promise(s=>{setTimeout(()=>{const o=u();if(o.some(e=>e.code.toUpperCase()===n.code.toUpperCase())){s({success:!1,message:"Bu kupon kodu zaten mevcut"});return}const r={...n,id:Date.now().toString(),usageCount:0};o.push(r),d(o),s({success:!0,data:r})},500)}),updateCoupon:async(n,s)=>new Promise(o=>{setTimeout(()=>{const r=u(),e=r.findIndex(i=>i.id===n);if(e===-1){o({success:!1,message:"Kupon bulunamadı"});return}r[e]={...r[e],...s},d(r),o({success:!0})},400)}),deleteCoupon:async n=>new Promise(s=>{setTimeout(()=>{const o=u(),r=o.filter(e=>e.id!==n);if(r.length===o.length){s({success:!1,message:"Kupon bulunamadı"});return}d(r),s({success:!0})},400)}),calculateDiscount:(n,s)=>n.type==="percentage"?Number((s*n.value/100).toFixed(2)):n.value};function O({cartTotal:n,appliedCoupon:s,onApplyCoupon:o,onRemoveCoupon:r}){const[e,i]=x.useState(""),[p,c]=x.useState(!1),[l,m]=x.useState(null),[,g]=x.useState(!1),f=async()=>{if(!e.trim())return;c(!0),m(null),g(!1);const a=await w.validateCoupon(e.trim(),n);a.success&&a.coupon?(g(!0),o(a.coupon),i("")):m(a.message||"Kupon uygulanamadı"),c(!1)},b=()=>{r(),i(""),m(null),g(!1)};return s?t.jsxs("div",{"code-path":"src/components/CouponInput.tsx:54:7",className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-4",children:[t.jsxs("div",{"code-path":"src/components/CouponInput.tsx:55:9",className:"flex items-center justify-between",children:[t.jsxs("div",{"code-path":"src/components/CouponInput.tsx:56:11",className:"flex items-center gap-3",children:[t.jsx("div",{"code-path":"src/components/CouponInput.tsx:57:13",className:"w-10 h-10 bg-green-100 dark:bg-green-800 rounded-full flex items-center justify-center",children:t.jsx(y,{"code-path":"src/components/CouponInput.tsx:58:15",className:"w-5 h-5 text-green-600 dark:text-green-400"})}),t.jsxs("div",{"code-path":"src/components/CouponInput.tsx:60:13",children:[t.jsx("p",{"code-path":"src/components/CouponInput.tsx:61:15",className:"font-semibold text-green-900 dark:text-green-400",children:s.code}),t.jsx("p",{"code-path":"src/components/CouponInput.tsx:64:15",className:"text-sm text-green-700 dark:text-green-500",children:s.type==="percentage"?`%${s.value} indirim uygulandı`:`€${s.value} indirim uygulandı`})]})]}),t.jsx(h,{"code-path":"src/components/CouponInput.tsx:72:11",variant:"ghost",size:"sm",onClick:b,className:"text-red-500 hover:text-red-700 hover:bg-red-50",children:t.jsx(v,{"code-path":"src/components/CouponInput.tsx:78:13",className:"w-4 h-4"})})]}),t.jsx("div",{"code-path":"src/components/CouponInput.tsx:81:9",className:"mt-3 pt-3 border-t border-green-200 dark:border-green-800",children:t.jsxs("p",{"code-path":"src/components/CouponInput.tsx:82:11",className:"text-sm text-green-800 dark:text-green-400",children:["İndirim: ",t.jsxs("span",{"code-path":"src/components/CouponInput.tsx:83:22",className:"font-bold",children:["-€ ",s.discountAmount.toFixed(2)]})]})})]}):t.jsxs("div",{"code-path":"src/components/CouponInput.tsx:91:5",className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4",children:[t.jsx("label",{"code-path":"src/components/CouponInput.tsx:92:7",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"İndirim Kodu"}),t.jsxs("div",{"code-path":"src/components/CouponInput.tsx:95:7",className:"flex gap-2",children:[t.jsxs("div",{"code-path":"src/components/CouponInput.tsx:96:9",className:"relative flex-1",children:[t.jsx(N,{"code-path":"src/components/CouponInput.tsx:97:11",className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx(j,{"code-path":"src/components/CouponInput.tsx:98:11",value:e,onChange:a=>{i(a.target.value),m(null)},placeholder:"Kupon kodunuzu girin",className:"pl-10",onKeyDown:a=>a.key==="Enter"&&f()})]}),t.jsx(h,{"code-path":"src/components/CouponInput.tsx:109:9",onClick:f,disabled:p||!e.trim(),className:"bg-[#0077be] hover:bg-[#005a8f] text-white",children:p?t.jsx(I,{"code-path":"src/components/CouponInput.tsx:115:13",className:"w-4 h-4 animate-spin"}):"Uygula"})]}),l&&t.jsxs("p",{"code-path":"src/components/CouponInput.tsx:123:9",className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[t.jsx(v,{"code-path":"src/components/CouponInput.tsx:124:11",className:"w-4 h-4"}),l]}),t.jsxs("div",{"code-path":"src/components/CouponInput.tsx:130:7",className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[t.jsx("p",{"code-path":"src/components/CouponInput.tsx:131:9",className:"text-xs text-gray-500 mb-2",children:"Örnek kupon kodları:"}),t.jsx("div",{"code-path":"src/components/CouponInput.tsx:132:9",className:"flex flex-wrap gap-2",children:["HOSGELDIN10","VIP20","SABIT50"].map(a=>t.jsx("button",{"code-path":"src/components/CouponInput.tsx:134:13",onClick:()=>i(a),className:"text-xs px-2 py-1 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded hover:border-[#0077be] transition-colors",children:a},a))})]})]})}export{O as C,j as I};
